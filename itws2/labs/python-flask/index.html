<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Intro to Flask</title>
<!-- 2020-12-12 Sat 19:19 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="VLEAD" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="../../style/css/worg-style.css" />
<link rel="stylesheet" type="text/css" href="../../style/css/override.css" />
<link rel="icon" type="image/png" href="../../style/img/favicon/popl.png" />
<script type="text/javascript" src="../../style/js/org-info.js">
/**
 *
 * @source: ../../style/js/org-info.js
 *
 * @licstart  The following is the entire license notice for the
 *  JavaScript code in ../../style/js/org-info.js.
 *
 * Copyright (C) 2012-2013 Free Software Foundation, Inc.
 *
 *
 * The JavaScript code in this tag is free software: you can
 * redistribute it and/or modify it under the terms of the GNU
 * General Public License (GNU GPL) as published by the Free Software
 * Foundation, either version 3 of the License, or (at your option)
 * any later version.  The code is distributed WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.
 *
 * As additional permission under GNU GPL version 3 section 7, you
 * may distribute non-source (e.g., minimized or compacted) forms of
 * that code without the copy of the GNU GPL normally required by
 * section 4, provided you include this license notice and a URL
 * through which recipients can access the Corresponding Source.
 *
 * @licend  The above is the entire license notice
 * for the JavaScript code in ../../style/js/org-info.js.
 *
 */
</script>

<script type="text/javascript">

/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/

<!--/*--><![CDATA[/*><!--*/
org_html_manager.set("TOC_DEPTH", "1");
org_html_manager.set("LINK_HOME", "../../index.html");
org_html_manager.set("LINK_UP", "../index.html");
org_html_manager.set("LOCAL_TOC", "1");
org_html_manager.set("VIEW_BUTTONS", "0");
org_html_manager.set("MOUSE_HINT", "underline");
org_html_manager.set("FIXED_TOC", "0");
org_html_manager.set("TOC", "1");
org_html_manager.set("VIEW", "info");
org_html_manager.setup();  // activate after the parameters are set
/*]]>*///-->
</script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="../index.html"> UP </a>
 |
 <a accesskey="H" href="../../index.html"> HOME </a>
</div><div id="content">
<h1 class="title">Intro to Flask</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. Objective of Lab</a>
<ul>
<li><a href="#sec-1-1">1.1. Model View Controller (MVC)</a></li>
<li><a href="#sec-1-2">1.2. Flask</a></li>
<li><a href="#sec-1-3">1.3. Models in Flask (Flask-SQLAlchemy)</a></li>
<li><a href="#sec-1-4">1.4. Flask Templates</a></li>
<li><a href="#sec-1-5">1.5. Flask Testing</a></li>
</ul>
</li>
<li><a href="#sec-2">2. Instructions</a>
<ul>
<li><a href="#sec-2-1">2.1. To install requirements</a></li>
<li><a href="#sec-2-2">2.2. To install Flask</a></li>
<li><a href="#sec-2-3">2.3. To install Flask-SQLALchemy</a></li>
<li><a href="#sec-2-4">2.4. Problem specific file names for your lab solutions</a></li>
<li><a href="#sec-2-5">2.5. Directory Structure</a></li>
</ul>
</li>
<li><a href="#sec-3">3. Problems</a>
<ul>
<li><a href="#sec-3-1">3.1. User details</a>
<ul>
<li><a href="#sec-3-1-1">3.1.1. To create a new user in the database.</a></li>
<li><a href="#sec-3-1-2">3.1.2. To fetch all the users in the database.</a></li>
<li><a href="#sec-3-1-3">3.1.3. To delete a user given it's username</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Objective of Lab</h2>
<div class="outline-text-2" id="text-1">
<p>
The objective of this lab is to learn about Flask, which is
a microframework for Python.
</p>
</div>

<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> Model View Controller (MVC)</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li>The Model-View-Controller (MVC) is an architectural
pattern that separates an application into three main
logical components: the model, the view, and the
controller.
</li>
<li>Each of these components are built to handle specific
development aspects of an application. MVC is one of the
most frequently used industry-standard web development
framework to create scalable and extensible projects.
</li>
<li>The Model component corresponds to all the data related
logic that the user works with. This can represent either
the data that is being transferred between the View and
Controller components or any other business logic related
data.
</li>
<li>The View component is used for all the UI logic of the
application.
</li>
<li>Controllers act as an interface between Model and View
components to process all the business logic and incoming
requests, manipulate data using the Model component and
interact with the Views to render the final output.
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> Flask</h3>
<div class="outline-text-3" id="text-1-2">
<ul class="org-ul">
<li>For creating a basic web application in Flask, we would
do this.
<pre class="example">
from flask import Flask
app = Flask(__name__)

@app.route("/")
def hello():
    return "Hello World!"

if __name__ == "__main__":
    app.run()
</pre>
</li>
<li>Finally to view the results, we can run <code>python
   helloworld.py</code> on the terminal and then browse to
<code>http://127.0.0.1:5000/</code>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3"><span class="section-number-3">1.3</span> Models in Flask (Flask-SQLAlchemy)</h3>
<div class="outline-text-3" id="text-1-3">
<ul class="org-ul">
<li>Using raw SQL in Flask web applications to perform CRUD
operations on database can be tedious. Instead,
SQLAlchemy, a Python toolkit is a powerful OR Mapper that
gives application developers the full power and
flexibility of SQL. Flask-SQLAlchemy is the Flask
extension that adds support for SQLAlchemy to your Flask
application.
</li>
</ul>
<pre class="example">
from flask import Flask
from flask_sqlalchemy import SQLAlchemy

app = Flask(__name__)
app.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:////tmp/test.db'
db = SQLAlchemy(app)


class User(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    username = db.Column(db.String(80), unique=True)
    email = db.Column(db.String(120), unique=True)

    def __init__(self, username, email):
        self.username = username
        self.email = email

    def __repr__(self):
        return '&lt;User %r&gt;' % self.username
</pre>
<ul class="org-ul">
<li>To create the initial database, just import the db object
from an interactive Python shell and run the
<code>SQLAlchemy.create _all()</code> method to create the tables and
database:
</li>
</ul>
<pre class="example">
&gt;&gt;&gt; from yourapplication import db
&gt;&gt;&gt; db.create_all()
</pre>
<ul class="org-ul">
<li>Boom, and there is your database. Now to create some
users:
</li>
</ul>
<pre class="example">
&gt;&gt;&gt; from yourapplication import User
&gt;&gt;&gt; admin = User('admin', 'admin@example.com')
&gt;&gt;&gt; guest = User('guest', 'guest@example.com')
</pre>
<ul class="org-ul">
<li>But they are not yet in the database, so let’s make sure
they are:
</li>
</ul>
<pre class="example">
&gt;&gt;&gt; db.session.add(admin)
&gt;&gt;&gt; db.session.add(guest)
&gt;&gt;&gt; db.session.commit()
</pre>
<ul class="org-ul">
<li>Accessing the data in database is easy as a pie:
</li>
</ul>
<pre class="example">
&gt;&gt;&gt; users = User.query.all()
[&lt;User u'admin'&gt;, &lt;User u'guest'&gt;]
&gt;&gt;&gt; admin = User.query.filter_by(username='admin').first()
&lt;User u'admin'&gt;
</pre>
</div>
</div>

<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4"><span class="section-number-3">1.4</span> Flask Templates</h3>
<div class="outline-text-3" id="text-1-4">
<ul class="org-ul">
<li>Flask uses jinja2 template engine. A web template
contains HTML syntax interspersed placeholders for
variables and expressions.
</li>
<li>For this example, we have 2 different files,
<code>layout.html</code> and <code>server.py</code>
</li>
</ul>
<pre class="example">
&lt;!-- File: layout.html --&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
   &lt;body&gt;
      &lt;h1&gt;Hello {{ name }}!&lt;/h1&gt;
   &lt;/body&gt;
&lt;/html&gt;
</pre>
<pre class="example">
# File: server.py
from flask import Flask, render_template
app = Flask(__name__)

@app.route('/hello/&lt;user&gt;')
def hello_name(user):
   return render_template('layout.html', name = user)

if __name__ == '__main__':
   app.run(debug = True)
</pre>
<ul class="org-ul">
<li>To view the results, run <code>python server.py</code> on the
terminal and then browse to
<code>http://127.0.0.1:5000/hello/name</code>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-1-5" class="outline-3">
<h3 id="sec-1-5"><span class="section-number-3">1.5</span> Flask Testing</h3>
<div class="outline-text-3" id="text-1-5">
<ul class="org-ul">
<li>Unit Testing is a level of software testing where
individual units/components of a software are tested. The
purpose is to validate that each unit of the software
performs as designed.
</li>
<li>For flask applications, testing can be done using the
<code>unittest</code> module.
</li>
<li>Let us write a test case for the example from <code>1.2</code>.
</li>
</ul>

<pre class="example">
import unittest
from helloworld import app


test_client = app.test_client()

class HelloWorldTests(unittest.TestCase):
    def test_hello(self):
        rv = test_client.get("/")
        self.assertEquals(rv.data.decode("utf-8"), "Hello World!")
</pre>
<ul class="org-ul">
<li>To run the tests, run <code>nosetests tests.py</code> on your
terminal.
</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Instructions</h2>
<div class="outline-text-2" id="text-2">
<ul class="org-ul">
<li>Firstly, please set your proxy settings in the terminal.
</li>
</ul>
</div>

<div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> To install requirements</h3>
<div class="outline-text-3" id="text-2-1">
<ul class="org-ul">
<li>Run <code>pip install -r requirements.txt</code>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2"><span class="section-number-3">2.2</span> To install Flask</h3>
<div class="outline-text-3" id="text-2-2">
<ul class="org-ul">
<li>Run the command in your terminal, <code>pip --user install
   Flask</code>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3"><span class="section-number-3">2.3</span> To install Flask-SQLALchemy</h3>
<div class="outline-text-3" id="text-2-3">
<ul class="org-ul">
<li>Run the command in your terminal, <code>pip --user install
   Flask-SQLAlchemy</code>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-2-4" class="outline-3">
<h3 id="sec-2-4"><span class="section-number-3">2.4</span> Problem specific file names for your lab solutions</h3>
<div class="outline-text-3" id="text-2-4">
<p>
There is only one problem in this lab. Please write out the
solutions in literate style in an org file called
<code>main.org</code>. Then make sure that the tangled solutions go to
the following python files:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="right" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="right">Problem</th>
<th scope="col" class="left">File Name</th>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">&#xa0;</th>
<th scope="col" class="left">&#xa0;</th>
</tr>
</thead>
<tbody>
<tr>
<td class="right">1.</td>
<td class="left"><code>users.py</code></td>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
<td class="left">&#xa0;</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-sec-2-5" class="outline-3">
<h3 id="sec-2-5"><span class="section-number-3">2.5</span> Directory Structure</h3>
<div class="outline-text-3" id="text-2-5">
<p>
In your Gitlab directory, you <b>must</b> follow the directory
structure as below:
</p>

<pre class="example">
     -------------------------
     &lt;roll-no&gt;
     |
     `----src
          |
          `--- labs
               |
               `--- lab-8
                    |--- main.org
     ------------------------
</pre>
</div>
</div>
</div>


<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Problems</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1"><span class="section-number-3">3.1</span> User details</h3>
<div class="outline-text-3" id="text-3-1">
<p>
Create a Flask application, with host 127.0.0.1 on port
5000, which implements the following APIs.
</p>
</div>

<div id="outline-container-sec-3-1-1" class="outline-4">
<h4 id="sec-3-1-1"><span class="section-number-4">3.1.1</span> To create a new user in the database.</h4>
<div class="outline-text-4" id="text-3-1-1">
<ul class="org-ul">
<li>Route: "/addUser"
</li>
<li>Method: POST
</li>
<li>Form-Keys: <code>username</code>, <code>email</code>
</li>
<li>Output-type: JSON
</li>
<li>Output: {<code>status</code>: <code>true</code> / <code>false</code>}
</li>
</ul>
</div>
</div>


<div id="outline-container-sec-3-1-2" class="outline-4">
<h4 id="sec-3-1-2"><span class="section-number-4">3.1.2</span> To fetch all the users in the database.</h4>
<div class="outline-text-4" id="text-3-1-2">
<ul class="org-ul">
<li>Route: "/users"
</li>
<li>Method: GET
</li>
<li>Form-Keys:
</li>
<li>Output-type: JSON
</li>
<li>Output: {<code>users</code>: [{<code>username</code>: &#x2026;, <code>email</code>: &#x2026;}, {<code>username</code>: &#x2026;, <code>email</code>: &#x2026;}]}
</li>
</ul>
</div>
</div>


<div id="outline-container-sec-3-1-3" class="outline-4">
<h4 id="sec-3-1-3"><span class="section-number-4">3.1.3</span> To delete a user given it's username</h4>
<div class="outline-text-4" id="text-3-1-3">
<ul class="org-ul">
<li>Route: "/deleteUser"
</li>
<li>Method: POST
</li>
<li>Form-Keys : <code>username</code>
</li>
<li>Output-type: JSON
</li>
<li>Output: {<code>status</code>: <code>true</code> / <code>false</code>}
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: VLEAD</p>
<p class="date">Created: 2020-12-12 Sat 19:19</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 25.2.2 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
